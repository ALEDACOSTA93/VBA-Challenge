Sub Stocks():For Each ws In Worksheets'Create Table HeadersDim headeri As Stringheaderi = "Ticker"ws.Cells(1, 9).Value = headeriDim headerj As Stringheaderj = "Yearly Change"ws.Cells(1, 10).Value = headerjDim headerk As Stringheaderk = "Percent Change"ws.Cells(1, 11).Value = headerkDim headerl As Stringheaderl = "Total Stock Volume"ws.Cells(1, 12).Value = headerlDim headero As Stringheadero = "Ticker"ws.Cells(1, 15) = headeroDim headerp As Stringheaderp = "Value"ws.Cells(1, 16) = headerpDim row2 As Stringrow2 = "Greatest % Increase"ws.Cells(2, 14) = row2Dim row3 As Stringrow3 = "Greatest % Decrese"ws.Cells(3, 14) = row3Dim row4 As Stringrow4 = "Greatest Total Volume"ws.Cells(4, 14) = row4'Declare variablesDim ticker As StringDim yearly_change As DoubleDim percent_change As Longyearly_change = 0percent_change = 0total_stock_volume = 0Dim summary_table_row As Integersummary_table_row = 2Dim lastrow1 As LongDim lastrow2 As LongDim lastrow3 As Longlastrow1 = ws.Cells(Rows.Count, 1).End(x1Up).Rowlastrow2 = ws.Cells(Rows.Count, 11).End(x1Up).Rowlastrow3 = ws.Cells(Rows.Count, 12).End(x1Up).Row'Loop through dataFor i = 2 To lastrow1    If ws.Cells(i + 1, 1).Value = ws.Cells(i, 1).Value Then        yearly_change = ws.Cells(i + 261, 3).Value - ws.Cells(i + 1, 6).Value        percent_change = yearly_change / ws.Cells(i + 1, 6).Value        total_stock_volume = ws.Cells(i, 7).Value            Else        ticker = ws.Cells(i, 1).Value        yearly_change = yearly_change + ws.Cells(i + 1, 6).Value - ws.Cells(i + 261, 3).Value        percent_change = yearly_change / ws.Cells(i + 1, 6).Value                       ws.Range("I" & summary_table_row).Value = ticker        ws.Range("J" & summary_table_row).Value = yearly_change        ws.Range("K" & summary_table_row).Value = percent_change        ws.Range("L" & summary_table_row).Value = total_stock_volume                summary_table_row = summary_table_row + 1        yearly_chage = 0        percent_change = 0        End If    Next i'Color code yearly changeFor i = 2 To lastrow2    If ws.Cells(i, 10) < 0 Then        ws.Cells(i, 10).Interior.ColorIndex = 3            Else        ws.Cells(i, 10).Interior.ColorIndex = 4            End IfNext i'Create second tableDim greatest_increase As LongDim greatest_decrease As LongDim greatest_total_volume As Longgreatest_increase = ws.WorksheetFunction.Max(Range("K2:lastrow2"))greatest_decrease = ws.WorksheetFunction.Min(Range("K2:lastrow2"))greatest_total_volume = ws.WorksheetFunction.Max(Range("L2:lastrow3"))'Loop through dataFor i = 2 To lastrow2    If ws.Cells(i, 11).Value = greatest_increase Then            ws.Cells(2, 15).Value = ws.Cells(i, 9).Value        ws.Cells(2, 16).Value = greatest_increase            ElseIf ws.Cells(i, 11).Value = greatest_decrease Then                ws.Cells(3, 15).Value = ws.Cells(i, 9).Value        ws.Cells(3, 16).Value = greatest_decrease            End If    Next iFor i = 2 To lastrow3   If ws.Cells(i, 12).Value = greatest_total_volume Then                ws.Cells(4, 15).Value = ws.Cells(i, 9).Value        ws.Cells(4, 16).Value = greatest_total_volume                End If            Next i    Next ws    End Sub